{{define "header"}}
<header class="header">
    <div class="logo">
        <a href="/">Ginger</a>
    </div>
    <nav class="nav">
        <ul>
            <li><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li><a href="/products">–ö–∞—Ç–∞–ª–æ–≥</a></li>
            <li><a href="/cart">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
            {{if .user}}
                <li><a href="/profile">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
                <li><a href="/logout">–í—ã–π—Ç–∏</a></li>
            {{else}}
                <li><a href="#" onclick="openModal('login-modal'); return false;">–í—Ö–æ–¥</a></li>
                <li><a href="#" onclick="openModal('register-modal'); return false;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
            {{end}}
        </ul>
    </nav>


    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('login-modal')">&times;</span>
            <h2>–í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
            <form id="login-form" method="POST" action="http://localhost:8080/authorization">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–∞—Ä–æ–ª—å</label>
                    <div class="password-wrapper">
                        <input type="password" id="login-password" name="password" class="form-control" required>
                        <span class="toggle-password" onclick="togglePassword('login-password')">üëÅÔ∏è</span>
                    </div>
                </div>
                <button type="submit" class="btn">–í–æ–π—Ç–∏</button>
                <div class="auth-footer">
                    –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="switchToRegister(); return false;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('register-modal')">&times;</span>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form id="register-form" method="POST" action="http://localhost:8080/registration">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">–ò–º—è</label>
                        <input type="text" id="name" name="name" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="reg-email">Email</label>
                    <input type="email" id="reg-email" name="email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="reg-password">–ü–∞—Ä–æ–ª—å</label>
                    <div class="password-wrapper">
                        <input type="password" id="reg-password" name="password" class="form-control" required>
                        <span class="toggle-password" onclick="togglePassword('reg-password')">üëÅÔ∏è</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="reg-confirm-password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <div class="password-wrapper">
                        <input type="password" id="reg-confirm-password" name="confirm_password" class="form-control" required>
                        <span class="toggle-password" onclick="togglePassword('reg-confirm-password')">üëÅÔ∏è</span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="role">–í—ã –±—É–¥–µ—Ç–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –∏–ª–∏ –ø–æ–∫—É–ø–∞—Ç—å —Ç–æ–≤–∞—Ä—ã?</label>
                        <div class="role-switch">
                            <input type="radio" id="role-customer" name="role" value="customer" checked>
                            <label for="role-customer">–ü–æ–∫—É–ø–∞—Ç—å</label>
                            
                            <input type="radio" id="role-salesman" name="role" value="salesman">
                            <label for="role-salesman">–ü—Ä–æ–¥–∞–≤–∞—Ç—å</label>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <div class="auth-footer">
                    –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="switchToLogin(); return false;">–í–æ–π–¥–∏—Ç–µ</a>
                </div>
            </form>
        </div>
    </div>
</header>

<style>
    /* –°—Ç–∏–ª–∏ —à–∞–ø–∫–∏ */
    .header {
        background-color: #2c3e50;
        color: white;
        padding: 1rem 0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        position: relative;
        z-index: 100;
    }
    
    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .logo {
        font-size: 1.8rem;
        font-weight: bold;
    }
    
    .logo a {
        color: white;
        text-decoration: none;
    }
    
    nav ul {
        display: flex;
        list-style: none;
    }
    
    nav ul li {
        margin-left: 1.5rem;
    }
    
    nav ul li a {
        color: white;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s;
    }
    
    nav ul li a:hover {
        color: #3498db;
    }
    
    .search input {
        padding: 0.5rem;
        border: none;
        border-radius: 4px;
    }
    
    .search button {
        padding: 0.5rem 1rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        overflow: auto;
    }
    
    .modal-content {
        background-color: #fff;
        margin: 2% auto; /* –ú–µ–Ω—å—à–µ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
        padding: 2rem;
        border-radius: 8px;
        width: 90%;
        max-width: 400px; /* –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        animation: modalopen 0.3s;
        color: #333;
        position: relative;
    }
    
    .form-container {
        overflow-y: auto;
        max-height: calc(90vh - 120px); /* –û—Å—Ç–∞–≤–ª—è–µ–º –º–µ—Å—Ç–æ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ —Ñ—É—Ç–µ—Ä–∞ */
        padding-right: 5px; /* –ß—Ç–æ–±—ã –Ω–µ –∑–∞–µ–∑–∂–∞–ª —Å–∫—Ä–æ–ª–ª –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç */
    }
    
    @keyframes modalopen {
        from {opacity: 0; transform: translateY(-50px);}
        to {opacity: 1; transform: translateY(0);}
    }
    
    .close-btn {
        float: right;
        font-size: 1.5rem;
        cursor: pointer;
        color: #7f8c8d;
    }
    
    .close-btn:hover {
        color: #333;
    }
    
    /* –°—Ç–∏–ª–∏ —Ñ–æ—Ä–º */
    .form-group {
        margin-bottom: 1.5rem;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
    }
    
    .form-control {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 1rem;
    }
    
    .btn {
        display: block;
        width: 100%;
        padding: 0.75rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    
    .btn:hover {
        background-color: #2980b9;
    }
    
    .auth-footer {
        text-align: center;
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid #eee;
    }
    
    .auth-footer a {
        color: #3498db;
        text-decoration: none;
    }
    
    .auth-footer a:hover {
        text-decoration: underline;
    }
    
    .form-row {
        display: flex;
        gap: 1rem;
    }
    
    .form-row .form-group {
        flex: 1;
    }
    .password-wrapper {
        position: relative;
    }
    
    .toggle-password {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        user-select: none;
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ä–æ–ª–µ–π */
    .role-switch {
        display: flex;
        gap: 1rem;
        margin-top: 0.5rem;
    }
    
    .role-switch input[type="radio"] {
        display: none;
    }
    
    .role-switch label {
        padding: 0.5rem 1rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .role-switch input[type="radio"]:checked + label {
        background-color: #3498db;
        color: white;
        border-color: #3498db;
    }
</style>

<script>
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
    function openModal(modalId) {
        closeAllModals();
        document.getElementById(modalId).style.display = 'block';
        document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    }
    
    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
        document.body.style.overflow = ''; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
    }
    
    function closeAllModals() {
        document.querySelectorAll('.modal').forEach(modal => {
            modal.style.display = 'none';
        });
        document.body.style.overflow = '';
    }
    
    function switchToRegister() {
        closeModal('login-modal');
        openModal('register-modal');
    }
    
    function switchToLogin() {
        closeModal('register-modal');
        openModal('login-modal');
    }

    //–î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
    function togglePassword(fieldId) {
        const passwordField = document.getElementById(fieldId);
        if (passwordField.type === 'password') {
            passwordField.type = 'text';
        } else {
            passwordField.type = 'password';
        }
    }
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
    window.onclick = function(event) {
        if (event.target.className === 'modal') {
            closeAllModals();
        }
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ fetch/AJAX)
    document.getElementById('login-form')?.addEventListener('submit', function(e) {
        e.preventDefault();
        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å AJAX-–∑–∞–ø—Ä–æ—Å
        this.submit();
    });
    
     // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ JSON
     document.getElementById('register-form')?.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = {
            name: this.elements['name'].value,
            email: this.elements['email'].value,
            password: this.elements['password'].value,
            confirm_password: this.elements['confirm_password'].value,
            role: this.elements['role'].value
        };
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
        fetch(this.action, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            closeAllModals();
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        })
        .catch((error) => {
            console.error('Error:', error);
        });

        closeAllModals();
    });
</script>
{{end}}